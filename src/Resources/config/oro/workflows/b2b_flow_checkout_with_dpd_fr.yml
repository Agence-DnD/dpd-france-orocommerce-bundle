workflows:
    b2b_flow_checkout_with_dpd_fr:
        entity: Oro\Bundle\CheckoutBundle\Entity\Checkout
        entity_attribute: checkout
        steps_display_ordered: true
        priority: 220
        defaults:
            active: false
        applications:
            - commerce
        exclusive_active_groups:
            - b2b_checkout_flow
        exclusive_record_groups:
            - b2b_checkout_flow
        attributes:
            billing_address:
                property_path: checkout.billingAddress
                type: null
                options: {  }
                default: null
            shipping_address:
                property_path: checkout.shippingAddress
                type: null
                options: {  }
                default: null
            save_billing_address:
                property_path: checkout.saveBillingAddress
                type: null
                options: {  }
                default: null
            save_shipping_address:
                property_path: checkout.saveShippingAddress
                type: null
                options: {  }
                default: null
            ship_to_billing_address:
                property_path: checkout.shipToBillingAddress
                type: null
                options: {  }
                default: null
            po_number:
                property_path: checkout.poNumber
                type: null
                options: {  }
                default: null
            ship_until:
                property_path: checkout.shipUntil
                type: null
                options: {  }
                default: null
            customer_notes:
                property_path: checkout.customerNotes
                type: null
                options: {  }
                default: null
            payment_method:
                property_path: checkout.paymentMethod
                type: null
                options: {  }
                default: null
            shipping_method:
                property_path: checkout.shippingMethod
                type: null
                options: {  }
                default: null
            shipping_method_type:
                property_path: checkout.shippingMethodType
                type: null
                options: {  }
                default: null
            # @ADD DND START
            delivery_phone:
                property_path: checkout.delivery_phone
                type: null
                options: { }
            dpd_fr_relay_id:
                property_path: checkout.dpd_fr_relay_id
                type: null
                options: { }
            # @ADD DND END
            billing_address_has_shipping:
                type: boolean
                default: false
                property_path: null
                options: {  }
            allow_manual_source_remove:
                type: boolean
                default: false
                property_path: null
                options: {  }
            disallow_billing_address_edit:
                type: boolean
                default: false
                property_path: null
                options: {  }
            disallow_shipping_address_edit:
                type: boolean
                default: false
                property_path: null
                options: {  }
            disallow_shipping_method_edit:
                type: boolean
                default: false
                property_path: null
                options: {  }
            remove_source:
                type: boolean
                default: false
                property_path: null
                options: {  }
            clear_source:
                type: boolean
                default: false
                property_path: null
                options: {  }
            auto_remove_source:
                type: boolean
                default: false
                property_path: null
                options: {  }
            source_remove_label:
                type: string
                default: ''
                property_path: null
                options: {  }
            edit_order_link:
                type: string
                default: ''
                property_path: null
                options: {  }
            payment_in_progress:
                type: bool
                default: false
                property_path: null
                options: {  }
            payment_validate:
                type: bool
                default: false
                property_path: null
                options: {  }
            payment_save_for_later:
                type: bool
                default: false
                property_path: null
                options: {  }
            additional_data:
                type: string
                default: ''
                property_path: null
                options: {  }
            state_token:
                type: string
                default: ''
                property_path: null
                options: {  }
            order:
                type: entity
                options:
                    class: Oro\Bundle\OrderBundle\Entity\Order
                property_path: null
                default: null
            visitor:
                type: entity
                options:
                    class: Oro\Bundle\CustomerBundle\Entity\CustomerVisitor
                property_path: null
                default: null
            email:
                type: string
                default: ''
                property_path: null
                options: {  }
            late_registration:
                type: array
                default: {  }
                property_path: null
                options: {  }
            customerConsents:
                type: object
                options:
                    class: Doctrine\Common\Collections\ArrayCollection
                property_path: null
                default: null
            consents_available:
                type: boolean
                default: false
                property_path: null
                options: {  }
            line_items_shipping_methods:
                type: array
                default: {  }
                property_path: null
                options: {  }
            grouped_line_items:
                type: array
                default: {  }
                property_path: null
                options: {  }
        steps:
            enter_credentials_step:
                order: 10
                allowed_transitions:
                    - back_to_enter_credentials
                    - back_to_billing_address
                    - continue_to_billing_address_as_guest
                    - start_from_quickorderform
                is_final: false
                _is_start: false
                entity_acl: {  }
                position: {  }
            customer_consents:
                order: 20
                allowed_transitions:
                    - back_to_enter_credentials
                    - continue_to_billing_address
                is_final: false
                _is_start: false
                entity_acl: {  }
                position: {  }
            enter_billing_address:
                order: 30
                allowed_transitions:
                    - verify_customer_consents
                    - back_to_enter_credentials
                    - back_to_customer_consents
                    - continue_to_shipping_address
                    - start_from_quickorderform
                is_final: false
                _is_start: false
                entity_acl: {  }
                position: {  }
            enter_shipping_address:
                order: 40
                allowed_transitions:
                    - verify_customer_consents
                    - continue_to_shipping_method
                    - back_to_enter_credentials
                    - back_to_customer_consents
                    - back_to_billing_address
                is_final: false
                _is_start: false
                entity_acl: {  }
                position: {  }
            enter_shipping_method:
                order: 50
                allowed_transitions:
                    - verify_customer_consents
                    - continue_to_payment
                    - back_to_enter_credentials
                    - back_to_customer_consents
                    - back_to_billing_address
                    - back_to_shipping_address
                is_final: false
                _is_start: false
                entity_acl: {  }
                position: {  }
            enter_payment:
                order: 60
                allowed_transitions:
                    - payment_error
                    - verify_customer_consents
                    - continue_to_order_review
                    - back_to_enter_credentials
                    - back_to_customer_consents
                    - back_to_billing_address
                    - back_to_shipping_address
                    - back_to_shipping_method
                is_final: false
                _is_start: false
                entity_acl: {  }
                position: {  }
            order_review:
                order: 70
                allowed_transitions:
                    - place_order
                    - verify_customer_consents
                    - verify_payment
                    - finish_checkout
                    - payment_error
                    - paid_partially
                    - back_to_enter_credentials
                    - back_to_customer_consents
                    - back_to_billing_address
                    - back_to_shipping_address
                    - back_to_shipping_method
                    - back_to_payment
                    - back_to_shipping_address_on_fail_address
                is_final: false
                _is_start: false
                entity_acl: {  }
                position: {  }
            order_created:
                order: 80
                is_final: true
                _is_start: false
                entity_acl: {  }
                allowed_transitions: {  }
                position: {  }
        transitions:
            __start__:
                is_start: true
                is_hidden: true
                transition_definition: __start___definition
                step_to: enter_billing_address
                is_unavailable_hidden: false
                acl_message: null
                frontend_options: {  }
                form_type: Oro\Bundle\WorkflowBundle\Form\Type\WorkflowTransitionType
                display_type: dialog
                destination_page: ''
                form_options: {  }
                page_template: null
                dialog_template: null
                init_entities: {  }
                init_routes: {  }
                init_datagrids: {  }
                init_context_attribute: init_context
                message_parameters: {  }
                triggers: {  }
            start_from_quote:
                is_start: true
                is_hidden: true
                transition_definition: __start___definition
                step_to: enter_billing_address
                is_unavailable_hidden: false
                acl_message: null
                frontend_options: {  }
                form_type: Oro\Bundle\WorkflowBundle\Form\Type\WorkflowTransitionType
                display_type: dialog
                destination_page: ''
                form_options: {  }
                page_template: null
                dialog_template: null
                init_entities: {  }
                init_routes: {  }
                init_datagrids: {  }
                init_context_attribute: init_context
                message_parameters: {  }
                triggers: {  }
            start_from_quote_as_guest:
                is_start: true
                is_hidden: true
                transition_definition: __start___definition
                step_to: enter_credentials_step
                is_unavailable_hidden: false
                acl_message: null
                frontend_options: {  }
                form_type: Oro\Bundle\WorkflowBundle\Form\Type\WorkflowTransitionType
                display_type: dialog
                destination_page: ''
                form_options: {  }
                page_template: null
                dialog_template: null
                init_entities: {  }
                init_routes: {  }
                init_datagrids: {  }
                init_context_attribute: init_context
                message_parameters: {  }
                triggers: {  }
            start_from_shoppinglist:
                is_start: true
                is_unavailable_hidden: true
                transition_definition: start_from_shoppinglist_definition
                frontend_options:
                    icon: fa-briefcase
                    data:
                        component_name: oro_shopping_list_matrix_to_create_order
                        page-component-module: oroshoppinglist/js/app/components/shoppinglist-create-order-button-component
                        page-component-options:
                            component_name: '[name$="[component]"]'
                            hasEmptyMatrix: $.result.shoppingListHasEmptyMatrix
                init_routes:
                    - oro_shopping_list_frontend_view
                    - oro_shopping_list_frontend_update
                init_entities:
                    - Oro\Bundle\ShoppingListBundle\Entity\ShoppingList
                acl_resource:
                    - CHECKOUT_CREATE
                    - $.result.shoppingList
                step_to: enter_credentials_step
                is_hidden: false
                acl_message: null
                form_type: Oro\Bundle\WorkflowBundle\Form\Type\WorkflowTransitionType
                display_type: dialog
                destination_page: ''
                form_options: {  }
                page_template: null
                dialog_template: null
                init_datagrids: {  }
                init_context_attribute: init_context
                message_parameters: {  }
                triggers: {  }
            start_from_quickorderform:
                is_start: true
                is_unavailable_hidden: true
                transition_definition: start_from_quickorderform_definition
                frontend_options:
                    icon: fa-clipboard
                    data:
                        component_name: oro_shopping_list_to_checkout_quick_add_processor
                        transition_name: start_from_quickorderform
                        page-component-module: oroproduct/js/app/components/quick-add-form-button-component
                        page-component-options:
                            transition_name: '[name$="[transition]"]'
                            component_name: '[name$="[component]"]'
                            confirmation: $.result.doShowConfirmation
                            shopping_list_limit: $.result.shoppingListLimit
                init_routes:
                    - oro_product_frontend_quick_add
                acl_resource:
                    - CREATE
                    - 'entity:commerce@Oro\Bundle\CheckoutBundle\Entity\Checkout'
                step_to: enter_credentials_step
                is_hidden: false
                acl_message: null
                form_type: Oro\Bundle\WorkflowBundle\Form\Type\WorkflowTransitionType
                display_type: dialog
                destination_page: ''
                form_options: {  }
                page_template: null
                dialog_template: null
                init_entities: {  }
                init_datagrids: {  }
                init_context_attribute: init_context
                message_parameters: {  }
                triggers: {  }
            finish_checkout:
                transition_definition: finish_checkout_definition
                is_hidden: true
                step_to: order_created
                is_start: false
                is_unavailable_hidden: false
                acl_message: null
                frontend_options: {  }
                form_type: Oro\Bundle\WorkflowBundle\Form\Type\WorkflowTransitionType
                display_type: dialog
                destination_page: ''
                form_options: {  }
                page_template: null
                dialog_template: null
                init_entities: {  }
                init_routes: {  }
                init_datagrids: {  }
                init_context_attribute: init_context
                message_parameters: {  }
                triggers: {  }
            payment_error:
                transition_definition: payment_error_definition
                is_hidden: true
                step_to: enter_payment
                is_start: false
                is_unavailable_hidden: false
                acl_message: null
                frontend_options: {  }
                form_type: Oro\Bundle\WorkflowBundle\Form\Type\WorkflowTransitionType
                display_type: dialog
                destination_page: ''
                form_options: {  }
                page_template: null
                dialog_template: null
                init_entities: {  }
                init_routes: {  }
                init_datagrids: {  }
                init_context_attribute: init_context
                message_parameters: {  }
                triggers: {  }
            paid_partially:
                step_to: enter_payment
                transition_definition: paid_partially_definition
                is_hidden: true
                is_start: false
                is_unavailable_hidden: false
                acl_message: null
                frontend_options: {  }
                form_type: Oro\Bundle\WorkflowBundle\Form\Type\WorkflowTransitionType
                display_type: dialog
                destination_page: ''
                form_options: {  }
                page_template: null
                dialog_template: null
                init_entities: {  }
                init_routes: {  }
                init_datagrids: {  }
                init_context_attribute: init_context
                message_parameters: {  }
                triggers: {  }
            continue_to_billing_address_as_guest:
                step_to: enter_billing_address
                transition_definition: continue_to_billing_address_as_guest_definition
                frontend_options:
                    icon: fa-briefcase
                    is_checkout_continue: true
                is_start: false
                is_hidden: false
                is_unavailable_hidden: false
                acl_message: null
                form_type: Oro\Bundle\WorkflowBundle\Form\Type\WorkflowTransitionType
                display_type: dialog
                destination_page: ''
                form_options: {  }
                page_template: null
                dialog_template: null
                init_entities: {  }
                init_routes: {  }
                init_datagrids: {  }
                init_context_attribute: init_context
                message_parameters: {  }
                triggers: {  }
            continue_to_billing_address:
                step_to: enter_billing_address
                transition_definition: continue_to_billing_address_definition
                display_type: page
                frontend_options:
                    is_checkout_continue: true
                    is_checkout_show_errors: true
                form_options:
                    form_init:
                        -
                            '@tree':
                                conditions:
                                    '@and':
                                        -
                                            '@not_empty': $checkout.customerUser
                                        -
                                            '@equal':
                                                - $checkout.customerUser.isGuest
                                                - false
                                actions:
                                    -
                                        '@assign_value':
                                            - $customerConsents
                                            - null
                        -
                            '@run_action_group':
                                action_group: update_checkout_state
                                parameters_mapping:
                                    checkout: $checkout
                                    state_token: $state_token
                                    update_checkout_state: $.result.updateCheckoutState
                                results:
                                    result.updateCheckoutState: $.update_checkout_state
                    attribute_fields:
                        customerConsents:
                            form_type: Oro\Bundle\ConsentBundle\Form\Type\ConsentAcceptanceType
                            options:
                                required: true
                                property_path: customerConsents
                                constraints:
                                    -
                                        Oro\Bundle\ConsentBundle\Validator\Constraints\RemovedConsents: null
                                    -
                                        Oro\Bundle\ConsentBundle\Validator\Constraints\RemovedLandingPages: null
                                label: oro.workflow.b2b_flow_checkout.transition.continue_to_billing_address.attribute.customer_consents.label
                        state_token:
                            form_type: Symfony\Component\Form\Extension\Core\Type\HiddenType
                            options:
                                label: oro.workflow.b2b_flow_checkout.transition.continue_to_billing_address.attribute.state_token.label
                is_start: false
                is_hidden: false
                is_unavailable_hidden: false
                acl_message: null
                form_type: Oro\Bundle\WorkflowBundle\Form\Type\WorkflowTransitionType
                destination_page: ''
                page_template: null
                dialog_template: null
                init_entities: {  }
                init_routes: {  }
                init_datagrids: {  }
                init_context_attribute: init_context
                message_parameters: {  }
                triggers: {  }
            continue_to_shipping_address:
                step_to: enter_shipping_address
                transition_definition: continue_to_shipping_address_definition
                display_type: page
                frontend_options:
                    is_checkout_continue: true
                    is_checkout_show_errors: true
                form_options:
                    form_init:
                        -
                            '@run_action_group':
                                action_group: update_checkout_state
                                parameters_mapping:
                                    checkout: $checkout
                                    state_token: $state_token
                                    update_checkout_state: $.result.updateCheckoutState
                                results:
                                    result.updateCheckoutState: $.update_checkout_state
                    attribute_fields:
                        billing_address:
                            form_type: Oro\Bundle\CheckoutBundle\Form\Type\CheckoutAddressType
                            options:
                                object: $checkout
                                addressType: billing
                                required: true
                                translation_domain: messages
                                constraints:
                                    -
                                        Valid: null
                                    -
                                        NotBlank: null
                                    -
                                        Oro\Bundle\AddressBundle\Validator\Constraints\NameOrOrganization: null
                                disabled: $disallow_billing_address_edit
                                label: oro.workflow.b2b_flow_checkout.transition.continue_to_shipping_address.attribute.billing_address.label
                        save_billing_address:
                            form_type: Oro\Bundle\CheckoutBundle\Form\Type\SaveAddressType
                            options:
                                label: oro.workflow.b2b_flow_checkout.transition.continue_to_shipping_address.attribute.save_billing_address.label
                        ship_to_billing_address:
                            form_type: Oro\Bundle\CheckoutBundle\Form\Type\ShipToBillingAddressType
                            options:
                                label: oro.workflow.b2b_flow_checkout.transition.continue_to_shipping_address.attribute.ship_to_billing_address.label
                        state_token:
                            form_type: Symfony\Component\Form\Extension\Core\Type\HiddenType
                            options:
                                label: oro.workflow.b2b_flow_checkout.transition.continue_to_shipping_address.attribute.state_token.label
                        email:
                            form_type: Oro\Bundle\CustomerBundle\Form\Type\CustomerVisitorEmailAddressType
                            options:
                                label: oro.workflow.b2b_flow_checkout.transition.continue_to_shipping_address.attribute.email.label
                is_start: false
                is_hidden: false
                is_unavailable_hidden: false
                acl_message: null
                form_type: Oro\Bundle\WorkflowBundle\Form\Type\WorkflowTransitionType
                destination_page: ''
                page_template: null
                dialog_template: null
                init_entities: {  }
                init_routes: {  }
                init_datagrids: {  }
                init_context_attribute: init_context
                message_parameters: {  }
                triggers: {  }
            continue_to_shipping_method:
                step_to: enter_shipping_method
                transition_definition: continue_to_shipping_method_definition
                display_type: page
                frontend_options:
                    is_checkout_continue: true
                    is_checkout_show_errors: true
                form_options:
                    form_init:
                        -
                            '@run_action_group':
                                action_group: update_checkout_state
                                parameters_mapping:
                                    checkout: $checkout
                                    state_token: $state_token
                                    update_checkout_state: $.result.updateCheckoutState
                                results:
                                    result.updateCheckoutState: $.update_checkout_state
                    attribute_fields:
                        shipping_address:
                            form_type: Oro\Bundle\CheckoutBundle\Form\Type\CheckoutAddressType
                            options:
                                object: $checkout
                                addressType: shipping
                                required: true
                                disabled: $disallow_shipping_address_edit
                                translation_domain: messages
                                constraints:
                                    -
                                        Valid: null
                                    -
                                        NotBlank: null
                                    -
                                        Oro\Bundle\AddressBundle\Validator\Constraints\NameOrOrganization: null
                                label: oro.workflow.b2b_flow_checkout.transition.continue_to_shipping_method.attribute.shipping_address.label
                        save_shipping_address:
                            form_type: Oro\Bundle\CheckoutBundle\Form\Type\SaveAddressType
                            options:
                                label: oro.workflow.b2b_flow_checkout.transition.continue_to_shipping_method.attribute.save_shipping_address.label
                        ship_to_billing_address:
                            form_type: Oro\Bundle\CheckoutBundle\Form\Type\ShipToBillingAddressType
                            options:
                                label: oro.workflow.b2b_flow_checkout.transition.continue_to_shipping_method.attribute.ship_to_billing_address.label
                        state_token:
                            form_type: Symfony\Component\Form\Extension\Core\Type\HiddenType
                            options:
                                label: oro.workflow.b2b_flow_checkout.transition.continue_to_shipping_method.attribute.state_token.label
                is_start: false
                is_hidden: false
                is_unavailable_hidden: false
                acl_message: null
                form_type: Oro\Bundle\WorkflowBundle\Form\Type\WorkflowTransitionType
                destination_page: ''
                page_template: null
                dialog_template: null
                init_entities: {  }
                init_routes: {  }
                init_datagrids: {  }
                init_context_attribute: init_context
                message_parameters: {  }
                triggers: {  }
            continue_to_payment:
                step_to: enter_payment
                transition_definition: continue_to_payment_definition
                frontend_options:
                    is_checkout_continue: true
                    is_checkout_show_errors: true
                    page_component_module: orocheckout/js/app/components/shipping-transition-button-component
                form_options:
                    form_init:
                        -
                            '@call_service_method':
                                service: oro_checkout.manager.multi_shipping.checkout_line_items_shipping
                                method: getCheckoutLineItemsShippingData
                                method_parameters:
                                    - $checkout
                                attribute: $line_items_shipping_methods
                        -
                            '@run_action_group':
                                action_group: update_checkout_state
                                parameters_mapping:
                                    checkout: $checkout
                                    state_token: $state_token
                                    update_checkout_state: $.result.updateCheckoutState
                                results:
                                    result.updateCheckoutState: $.update_checkout_state
                    attribute_fields:
                        shipping_method:
                            options:
                                constraints:
                                    -
                                        NotBlank: null
                                label: oro.workflow.b2b_flow_checkout.transition.continue_to_payment.attribute.shipping_method.label
                        shipping_method_type:
                            options:
                                constraints:
                                    -
                                        NotBlank: null
                                label: oro.workflow.b2b_flow_checkout.transition.continue_to_payment.attribute.shipping_method_type.label
                        # @ADD DND START
                        delivery_phone:
                            form_type: Symfony\Component\Form\Extension\Core\Type\HiddenType
                            options: null
                        dpd_fr_relay_id:
                            form_type: Symfony\Component\Form\Extension\Core\Type\HiddenType
                            options: null
                        # @ADD DND END
                        line_items_shipping_methods:
                            form_type: Oro\Bundle\CheckoutBundle\Form\Type\LineItemShippingMethodsType
                            options:
                                checkout: $checkout
                                label: oro.workflow.b2b_flow_checkout.transition.continue_to_payment.attribute.line_items_shipping_methods.label
                        state_token:
                            form_type: Symfony\Component\Form\Extension\Core\Type\HiddenType
                            options:
                                label: oro.workflow.b2b_flow_checkout.transition.continue_to_payment.attribute.state_token.label
                is_start: false
                is_hidden: false
                is_unavailable_hidden: false
                acl_message: null
                form_type: Oro\Bundle\WorkflowBundle\Form\Type\WorkflowTransitionType
                display_type: dialog
                destination_page: ''
                page_template: null
                dialog_template: null
                init_entities: {  }
                init_routes: {  }
                init_datagrids: {  }
                init_context_attribute: init_context
                message_parameters: {  }
                triggers: {  }
            continue_to_order_review:
                step_to: order_review
                transition_definition: continue_to_order_review_definition
                frontend_options:
                    is_checkout_continue: true
                    is_checkout_show_errors: true
                    page_component_module: orocheckout/js/app/components/payment-transition-button-component
                form_options:
                    form_init:
                        -
                            '@tree':
                                conditions:
                                    '@blank': $.result.shippingPriceUpdated
                                actions:
                                    -
                                        '@assign_value':
                                            - $.result.shippingPriceUpdated
                                            - true
                                    -
                                        '@run_action_group':
                                            action_group: oro_update_shipping_price
                                            parameters_mapping:
                                                checkout: $checkout
                        -
                            '@tree':
                                conditions:
                                    '@blank': $payment_validate
                                actions:
                                    -
                                        '@assign_value':
                                            - $payment_validate
                                            - true
                                    -
                                        '@call_service_method':
                                            conditions:
                                                '@blank': $.result.validatePaymentTransaction
                                            parameters:
                                                service: oro_payment.provider.payment_transaction
                                                method: getActiveValidatePaymentTransaction
                                                method_parameters:
                                                    - $payment_method
                                                attribute: $.result.validatePaymentTransaction
                                    -
                                        '@assign_value':
                                            conditions:
                                                '@not_empty':
                                                    - $.result.validatePaymentTransaction
                                            parameters:
                                                - $payment_validate
                                                - false
                        -
                            '@run_action_group':
                                action_group: update_checkout_state
                                parameters_mapping:
                                    checkout: $checkout
                                    state_token: $state_token
                                    update_checkout_state: $.result.updateCheckoutState
                                results:
                                    result.updateCheckoutState: $.update_checkout_state
                    attribute_fields:
                        payment_method:
                            options:
                                label: oro.workflow.b2b_flow_checkout.transition.continue_to_order_review.attribute.payment_method.label
                        payment_validate:
                            form_type: Symfony\Component\Form\Extension\Core\Type\CheckboxType
                            options:
                                label: oro.workflow.b2b_flow_checkout.transition.continue_to_order_review.attribute.payment_validate.label
                        payment_save_for_later:
                            form_type: Symfony\Component\Form\Extension\Core\Type\CheckboxType
                            options:
                                label: oro.workflow.b2b_flow_checkout.transition.continue_to_order_review.attribute.payment_save_for_later.label
                        state_token:
                            form_type: Symfony\Component\Form\Extension\Core\Type\HiddenType
                            options:
                                label: oro.workflow.b2b_flow_checkout.transition.continue_to_order_review.attribute.state_token.label
                        additional_data:
                            form_type: Symfony\Component\Form\Extension\Core\Type\HiddenType
                            options:
                                label: oro.workflow.b2b_flow_checkout.transition.continue_to_order_review.attribute.additional_data.label
                is_start: false
                is_hidden: false
                is_unavailable_hidden: false
                acl_message: null
                form_type: Oro\Bundle\WorkflowBundle\Form\Type\WorkflowTransitionType
                display_type: dialog
                destination_page: ''
                page_template: null
                dialog_template: null
                init_entities: {  }
                init_routes: {  }
                init_datagrids: {  }
                init_context_attribute: init_context
                message_parameters: {  }
                triggers: {  }
            back_to_enter_credentials:
                step_to: enter_credentials_step
                transition_definition: clear_payment_method_and_recalculate_state_definition
                is_start: false
                is_hidden: false
                is_unavailable_hidden: false
                acl_message: null
                frontend_options: {  }
                form_type: Oro\Bundle\WorkflowBundle\Form\Type\WorkflowTransitionType
                display_type: dialog
                destination_page: ''
                form_options: {  }
                page_template: null
                dialog_template: null
                init_entities: {  }
                init_routes: {  }
                init_datagrids: {  }
                init_context_attribute: init_context
                message_parameters: {  }
                triggers: {  }
            back_to_customer_consents:
                step_to: customer_consents
                transition_definition: clear_payment_method_and_recalculate_state_definition
                frontend_options:
                    is_checkout_back: true
                is_start: false
                is_hidden: false
                is_unavailable_hidden: false
                acl_message: null
                form_type: Oro\Bundle\WorkflowBundle\Form\Type\WorkflowTransitionType
                display_type: dialog
                destination_page: ''
                form_options: {  }
                page_template: null
                dialog_template: null
                init_entities: {  }
                init_routes: {  }
                init_datagrids: {  }
                init_context_attribute: init_context
                message_parameters: {  }
                triggers: {  }
            back_to_billing_address:
                step_to: enter_billing_address
                transition_definition: clear_payment_method_and_recalculate_state_definition
                frontend_options:
                    is_checkout_back: true
                is_start: false
                is_hidden: false
                is_unavailable_hidden: false
                acl_message: null
                form_type: Oro\Bundle\WorkflowBundle\Form\Type\WorkflowTransitionType
                display_type: dialog
                destination_page: ''
                form_options: {  }
                page_template: null
                dialog_template: null
                init_entities: {  }
                init_routes: {  }
                init_datagrids: {  }
                init_context_attribute: init_context
                message_parameters: {  }
                triggers: {  }
            back_to_shipping_address:
                step_to: enter_shipping_address
                transition_definition: clear_payment_method_and_recalculate_state_definition
                frontend_options:
                    is_checkout_back: true
                is_start: false
                is_hidden: false
                is_unavailable_hidden: false
                acl_message: null
                form_type: Oro\Bundle\WorkflowBundle\Form\Type\WorkflowTransitionType
                display_type: dialog
                destination_page: ''
                form_options: {  }
                page_template: null
                dialog_template: null
                init_entities: {  }
                init_routes: {  }
                init_datagrids: {  }
                init_context_attribute: init_context
                message_parameters: {  }
                triggers: {  }
            back_to_shipping_address_on_fail_address:
                step_to: enter_shipping_address
                transition_definition: unblock_and_recalculate_definition
                is_hidden: true
                is_start: false
                is_unavailable_hidden: false
                acl_message: null
                frontend_options: {  }
                form_type: Oro\Bundle\WorkflowBundle\Form\Type\WorkflowTransitionType
                display_type: dialog
                destination_page: ''
                form_options: {  }
                page_template: null
                dialog_template: null
                init_entities: {  }
                init_routes: {  }
                init_datagrids: {  }
                init_context_attribute: init_context
                message_parameters: {  }
                triggers: {  }
            back_to_shipping_method:
                step_to: enter_shipping_method
                transition_definition: back_to_shipping_method_definition
                frontend_options:
                    is_checkout_back: true
                is_start: false
                is_hidden: false
                is_unavailable_hidden: false
                acl_message: null
                form_type: Oro\Bundle\WorkflowBundle\Form\Type\WorkflowTransitionType
                display_type: dialog
                destination_page: ''
                form_options: {  }
                page_template: null
                dialog_template: null
                init_entities: {  }
                init_routes: {  }
                init_datagrids: {  }
                init_context_attribute: init_context
                message_parameters: {  }
                triggers: {  }
            back_to_payment:
                step_to: enter_payment
                transition_definition: recalculate_state_definition
                frontend_options:
                    is_checkout_back: true
                is_start: false
                is_hidden: false
                is_unavailable_hidden: false
                acl_message: null
                form_type: Oro\Bundle\WorkflowBundle\Form\Type\WorkflowTransitionType
                display_type: dialog
                destination_page: ''
                form_options: {  }
                page_template: null
                dialog_template: null
                init_entities: {  }
                init_routes: {  }
                init_datagrids: {  }
                init_context_attribute: init_context
                message_parameters: {  }
                triggers: {  }
            verify_customer_consents:
                step_to: customer_consents
                transition_definition: verify_customer_consents_definition
                is_hidden: true
                frontend_options:
                    stop_propagation: true
                is_start: false
                is_unavailable_hidden: false
                acl_message: null
                form_type: Oro\Bundle\WorkflowBundle\Form\Type\WorkflowTransitionType
                display_type: dialog
                destination_page: ''
                form_options: {  }
                page_template: null
                dialog_template: null
                init_entities: {  }
                init_routes: {  }
                init_datagrids: {  }
                init_context_attribute: init_context
                message_parameters: {  }
                triggers: {  }
            verify_payment:
                step_to: enter_payment
                transition_definition: verify_payment_definition
                is_hidden: true
                frontend_options:
                    is_checkout_verify: true
                is_start: false
                is_unavailable_hidden: false
                acl_message: null
                form_type: Oro\Bundle\WorkflowBundle\Form\Type\WorkflowTransitionType
                display_type: dialog
                destination_page: ''
                form_options: {  }
                page_template: null
                dialog_template: null
                init_entities: {  }
                init_routes: {  }
                init_datagrids: {  }
                init_context_attribute: init_context
                message_parameters: {  }
                triggers: {  }
            place_order:
                step_to: order_review
                transition_definition: place_order_definition
                display_type: page
                frontend_options:
                    is_checkout_continue: true
                    is_checkout_show_errors: true
                form_options:
                    form_init:
                        -
                            '@tree':
                                conditions:
                                    '@blank': $.result.shippingPriceUpdated
                                actions:
                                    -
                                        '@assign_value':
                                            - $.result.shippingPriceUpdated
                                            - true
                                    -
                                        '@run_action_group':
                                            action_group: oro_update_shipping_price
                                            parameters_mapping:
                                                checkout: $checkout
                        -
                            '@assign_value':
                                - $late_registration.email
                                - $email
                        -
                            '@run_action_group':
                                action_group: update_checkout_state
                                parameters_mapping:
                                    checkout: $checkout
                                    state_token: $state_token
                                    update_checkout_state: $.result.updateCheckoutState
                                results:
                                    result.updateCheckoutState: $.update_checkout_state
                    attribute_fields:
                        remove_source:
                            options:
                                label: oro.workflow.b2b_flow_checkout.transition.place_order.attribute.remove_source.label
                        po_number:
                            options:
                                label: oro.workflow.b2b_flow_checkout.transition.place_order.attribute.po_number.label
                        ship_until:
                            form_type: Oro\Bundle\CheckoutBundle\Form\Type\CheckoutShipUntilType
                            options:
                                checkout: $checkout
                                label: oro.workflow.b2b_flow_checkout.transition.place_order.attribute.ship_until.label
                        late_registration:
                            form_type: Oro\Bundle\CheckoutBundle\Form\Type\LateRegistrationType
                            options:
                                required: true
                                label: oro.workflow.b2b_flow_checkout.transition.place_order.attribute.late_registration.label
                        customer_notes:
                            form_type: Symfony\Component\Form\Extension\Core\Type\TextareaType
                            options:
                                label: oro.workflow.b2b_flow_checkout.transition.place_order.attribute.customer_notes.label
                        state_token:
                            form_type: Symfony\Component\Form\Extension\Core\Type\HiddenType
                            options:
                                label: oro.workflow.b2b_flow_checkout.transition.place_order.attribute.state_token.label
                is_start: false
                is_hidden: false
                is_unavailable_hidden: false
                acl_message: null
                form_type: Oro\Bundle\WorkflowBundle\Form\Type\WorkflowTransitionType
                destination_page: ''
                page_template: null
                dialog_template: null
                init_entities: {  }
                init_routes: {  }
                init_datagrids: {  }
                init_context_attribute: init_context
                message_parameters: {  }
                triggers: {  }
        transition_definitions:
            __start___definition:
                actions:
                    -
                        '@assign_value':
                            - $shipping_method
                            - null
                    -
                        '@assign_value':
                            - $payment_save_for_later
                            - true
                    -
                        '@delete_checkout_state':
                            conditions:
                                '@not_blank': $state_token
                            parameters:
                                entity: $checkout
                                token: $state_token
                    -
                        '@generate_uuid':
                            conditions:
                                '@blank': $state_token
                            parameters:
                                attribute: $state_token
                preactions: {  }
                preconditions: {  }
                conditions: {  }
            start_from_quickorderform_definition:
                preactions:
                    -
                        '@call_service_method':
                            conditions:
                                '@blank': $.result.isAllowed
                            parameters:
                                attribute: $.result.isAllowed
                                service: oro_shopping_list.processor.quick_add_to_checkout
                                method: isAllowed
                    -
                        '@call_service_method':
                            conditions:
                                '@blank': $.result.isReachedLimit
                            parameters:
                                attribute: $.result.isReachedLimit
                                service: oro_shopping_list.manager.shopping_list_limit
                                method: isReachedLimit
                    -
                        '@call_service_method':
                            conditions:
                                '@blank': $.result.shoppingListLimit
                            parameters:
                                attribute: $.result.shoppingListLimit
                                service: oro_shopping_list.manager.shopping_list_limit
                                method: getShoppingListLimitForUser
                    -
                        '@call_service_method':
                            conditions:
                                '@blank': $.result.isCheckoutAllowed
                            parameters:
                                service: oro_checkout.condition.is_workflow_start_from_shopping_list_allowed
                                method: isAllowedForAny
                                attribute: $.result.isCheckoutAllowed
                    -
                        '@call_service_method':
                            conditions:
                                '@blank': $.result.isCurrentShoppingListEmpty
                            parameters:
                                service: oro_shopping_list.manager.current_shopping_list
                                method: isCurrentShoppingListEmpty
                                attribute: $.result.isCurrentShoppingListEmpty
                    -
                        '@assign_value':
                            - $.result.doShowConfirmation
                            - false
                    -
                        '@assign_value':
                            conditions:
                                '@and':
                                    -
                                        '@equal':
                                            - $.result.isReachedLimit
                                            - true
                                    -
                                        '@equal':
                                            - $.result.isCurrentShoppingListEmpty
                                            - false
                            parameters:
                                - $.result.doShowConfirmation
                                - true
                preconditions:
                    '@and':
                        -
                            '@equal':
                                - true
                                - $.result.isAllowed
                        -
                            '@equal':
                                - true
                                - $.result.isCheckoutAllowed
                actions:
                    -
                        '@delete_checkout_state':
                            conditions:
                                '@not_blank': $state_token
                            parameters:
                                entity: $checkout
                                token: $state_token
                    -
                        '@transit_workflow':
                            conditions:
                                '@and':
                                    -
                                        '@current_step_name_is_equal':
                                            main_entity: $checkout
                                            step_name: enter_credentials_step
                                            workflow: $.definition.name
                                    -
                                        '@not_empty': $checkout.customerUser
                                    -
                                        '@not_equal':
                                            - $checkout.customerUser.isGuest
                                            - true
                            parameters:
                                entity: $checkout
                                transition: back_to_billing_address
                                workflow: $.definition.name
                conditions: {  }
            start_from_shoppinglist_definition:
                preactions:
                    -
                        '@find_entity':
                            conditions:
                                '@and':
                                    -
                                        '@not_blank': $init_context
                                    -
                                        '@blank': $.result.shoppingList
                            parameters:
                                class: $init_context.entityClass
                                identifier: $init_context.entityId
                                attribute: $.result.shoppingList
                    -
                        '@tree':
                            conditions:
                                '@and':
                                    -
                                        '@not_blank': $.result.shoppingList
                                    -
                                        '@blank': $.result.extendableConditionShoppingListStart
                            actions:
                                -
                                    '@assign_value':
                                        - $.result.extendableConditionShoppingListStart
                                        - false
                                -
                                    '@assign_value':
                                        conditions:
                                            '@extendable':
                                                events:
                                                    - extendable_condition.shopping_list_start
                                        parameters:
                                            - $.result.extendableConditionShoppingListStart
                                            - true
                    -
                        '@call_service_method':
                            conditions:
                                '@blank': $isAllowed
                            parameters:
                                service: oro_checkout.condition.is_workflow_start_from_shopping_list_allowed
                                method: isAllowedForAny
                                attribute: $isAllowed
                    -
                        '@call_service_method':
                            conditions:
                                '@and':
                                    -
                                        '@not_blank': $.result.shoppingList
                                    -
                                        '@blank': $.result.shoppingListHasEmptyMatrix
                            parameters:
                                service: oro_shopping_list.manager.empty_matrix_grid
                                method: hasEmptyMatrix
                                method_parameters:
                                    - $.result.shoppingList
                                attribute: $.result.shoppingListHasEmptyMatrix
                preconditions:
                    '@and':
                        -
                            '@equal':
                                - $isAllowed
                                - true
                        -
                            '@not_empty': $.result.shoppingList
                        -
                            '@has_elements': $.result.shoppingList.lineItems
                        -
                            '@equal':
                                - $.result.extendableConditionShoppingListStart
                                - true
                actions:
                    -
                        '@run_action_group':
                            action_group: start_shoppinglist_checkout
                            parameters_mapping:
                                shoppingList: $.result.shoppingList
                                showErrors: true
                            results:
                                data.checkout: $.checkout
                                result.redirectUrl: $.redirectUrl
                    -
                        '@delete_checkout_state':
                            conditions:
                                '@not_blank': $state_token
                            parameters:
                                entity: $checkout
                                token: $state_token
                    -
                        '@transit_workflow':
                            conditions:
                                '@or':
                                    -
                                        '@empty': $.result.shoppingList.customerUser
                                    -
                                        '@equal':
                                            - $.result.shoppingList.customerUser.isGuest
                                            - true
                            parameters:
                                entity: $checkout
                                transition: back_to_enter_credentials
                                workflow: $.definition.name
                conditions: {  }
            unblock_and_recalculate_definition:
                actions:
                    -
                        '@assign_value':
                            -
                                - $payment_method
                                - null
                            -
                                - $payment_in_progress
                                - false
                    -
                        '@generate_uuid': $state_token
                preactions: {  }
                preconditions: {  }
                conditions: {  }
            payment_error_definition:
                actions:
                    -
                        '@assign_value':
                            -
                                - $payment_method
                                - null
                            -
                                - $payment_in_progress
                                - false
                    -
                        '@remove_entity':
                            conditions:
                                '@not_empty': $order
                            parameters:
                                - $order
                    -
                        '@unset_value':
                            - $.data.order
                    -
                        '@generate_uuid': $state_token
                preactions: {  }
                preconditions: {  }
                conditions: {  }
            continue_to_billing_address_as_guest_definition:
                actions:
                    -
                        '@transit_workflow':
                            conditions:
                                '@not':
                                    -
                                        '@is_consents_accepted':
                                            acceptedConsents: $customerConsents
                            parameters:
                                entity: $checkout
                                transition: back_to_customer_consents
                                workflow: $.definition.name
                preactions: {  }
                preconditions: {  }
                conditions: {  }
            continue_to_billing_address_definition:
                preactions:
                    -
                        '@assign_value':
                            - $consents_available
                            - true
                actions:
                    -
                        '@save_accepted_consents':
                            acceptedConsents: $customerConsents
                    -
                        '@tree':
                            conditions:
                                '@and':
                                    -
                                        '@not_empty': $checkout.customerUser
                                    -
                                        '@equal':
                                            - $checkout.customerUser.isGuest
                                            - false
                            actions:
                                -
                                    '@assign_value':
                                        - $customerConsents
                                        - null
                    -
                        '@generate_uuid': $state_token
                preconditions: {  }
                conditions: {  }
            verify_customer_consents_definition:
                preactions:
                    -
                        '@tree':
                            conditions:
                                '@blank': $.result.isConsentsAccepted
                            actions:
                                -
                                    '@assign_value':
                                        - $.result.isConsentsAccepted
                                        - false
                                -
                                    '@assign_value':
                                        conditions:
                                            '@is_consents_accepted':
                                                acceptedConsents: $customerConsents
                                        parameters:
                                            - $.result.isConsentsAccepted
                                            - true
                    -
                        '@flash_message':
                            conditions:
                                '@and':
                                    -
                                        '@equal':
                                            - $.result.isConsentsAccepted
                                            - false
                                    -
                                        '@equal':
                                            - $consents_available
                                            - true
                            message: oro.checkout.workflow.condition.required_consents_should_be_checked.message
                            type: warning
                preconditions:
                    '@equal':
                        - $.result.isConsentsAccepted
                        - false
                conditions: {  }
                actions: {  }
            continue_to_shipping_address_definition:
                preactions:
                    -
                        '@run_action_group':
                            action_group: order_line_items_not_empty
                            parameters_mapping:
                                checkout: $checkout
                            results:
                                result.orderLineItemsNotEmpty: $.orderLineItemsNotEmpty
                                result.orderLineItemsNotEmptyForRfp: $.orderLineItemsNotEmptyForRfp
                    -
                        '@tree':
                            conditions:
                                '@blank': $.result.extendableConditionCheckout
                            actions:
                                -
                                    '@assign_value':
                                        - $.result.extendableConditionCheckout
                                        - false
                                -
                                    '@assign_value':
                                        conditions:
                                            '@extendable':
                                                events:
                                                    - extendable_condition.checkout
                                        parameters:
                                            - $.result.extendableConditionCheckout
                                            - true
                    -
                        '@call_service_method':
                            service: oro_checkout.provider.multi_shipping_config
                            method: isLineItemsGroupingEnabled
                            method_parameters: {  }
                            attribute: $.result.isLineItemsGroupingEnabled
                    -
                        '@call_service_method':
                            conditions:
                                '@equal':
                                    - $.result.isLineItemsGroupingEnabled
                                    - true
                            parameters:
                                service: oro_checkout.provider.grouped_line_items
                                method: getGroupedLineItemsIds
                                method_parameters:
                                    - $checkout
                                attribute: $grouped_line_items
                preconditions:
                    '@and':
                        -
                            '@equal':
                                - $checkout.completed
                                - false
                        -
                            '@equal':
                                parameters:
                                    - $.result.orderLineItemsNotEmptyForRfp
                                    - true
                                message: oro.checkout.workflow.condition.order_line_items_not_empty.not_allow_rfp.message
                        -
                            '@equal':
                                parameters:
                                    - $.result.orderLineItemsNotEmpty
                                    - true
                                message: oro.checkout.workflow.condition.order_line_items_not_empty.allow_rfp.message
                        -
                            '@quote_acceptable':
                                - $checkout.sourceEntity
                                - true
                        -
                            '@equal':
                                - $.result.extendableConditionCheckout
                                - true
                conditions:
                    '@and':
                        -
                            '@is_checkout_state_valid':
                                message: oro.checkout.workflow.condition.content_of_order_was_changed.message
                                parameters:
                                    entity: $checkout
                                    token: $state_token
                                    current_state: $.result.currentCheckoutState
                        -
                            '@not_empty': $checkout.billingAddress
                actions:
                    -
                        '@run_action_group':
                            action_group: b2b_flow_checkout_update_guest_customer_user
                            parameters_mapping:
                                checkout: $checkout
                                email: $email
                                billing_address: $billing_address
                    -
                        '@run_action_group':
                            action_group: b2b_flow_checkout_create_guest_customer_user
                            parameters_mapping:
                                checkout: $checkout
                                email: $email
                                billing_address: $billing_address
                    -
                        '@run_action_group':
                            action_group: b2b_flow_checkout_update_billing_address
                            parameters_mapping:
                                checkout: $checkout
                                disallow_shipping_address_edit: $disallow_shipping_address_edit
                            results:
                                data.billing_address_has_shipping: $.billing_address_has_shipping
                    -
                        '@save_accepted_consents':
                            acceptedConsents: $customerConsents
                    -
                        '@tree':
                            conditions:
                                '@and':
                                    -
                                        '@not_empty': $checkout.customerUser
                                    -
                                        '@equal':
                                            - $checkout.customerUser.isGuest
                                            - false
                            actions:
                                -
                                    '@assign_value':
                                        - $customerConsents
                                        - null
                    -
                        '@generate_uuid': $state_token
                    -
                        '@tree':
                            conditions:
                                '@equal':
                                    - true
                                    - $ship_to_billing_address
                            actions:
                                -
                                    '@transit_workflow':
                                        entity: $checkout
                                        transition: continue_to_shipping_method
                                        workflow: $.definition.name
            continue_to_shipping_method_definition:
                preactions:
                    -
                        '@run_action_group':
                            action_group: order_line_items_not_empty
                            parameters_mapping:
                                checkout: $checkout
                            results:
                                result.orderLineItemsNotEmpty: $.orderLineItemsNotEmpty
                                result.orderLineItemsNotEmptyForRfp: $.orderLineItemsNotEmptyForRfp
                preconditions:
                    '@and':
                        -
                            '@equal':
                                - $checkout.completed
                                - false
                        -
                            '@equal':
                                parameters:
                                    - $.result.orderLineItemsNotEmptyForRfp
                                    - true
                                message: oro.checkout.workflow.condition.order_line_items_not_empty.not_allow_rfp.message
                        -
                            '@equal':
                                parameters:
                                    - $.result.orderLineItemsNotEmpty
                                    - true
                                message: oro.checkout.workflow.condition.order_line_items_not_empty.allow_rfp.message
                        -
                            '@quote_acceptable':
                                - $checkout.sourceEntity
                                - true
                conditions:
                    '@and':
                        -
                            '@is_checkout_state_valid':
                                message: oro.checkout.workflow.condition.content_of_order_was_changed.message
                                parameters:
                                    entity: $checkout
                                    token: $state_token
                                    current_state: $.result.currentCheckoutState
                        -
                            '@or':
                                -
                                    '@equal':
                                        - $checkout.shipToBillingAddress
                                        - true
                                -
                                    '@and':
                                        -
                                            '@equal':
                                                - $checkout.shipToBillingAddress
                                                - false
                                        -
                                            '@not_empty': $checkout.shippingAddress
                actions:
                    -
                        '@run_action_group':
                            action_group: b2b_flow_checkout_update_shipping_address
                            parameters_mapping:
                                checkout: $checkout
                    -
                        '@call_service_method':
                            service: oro_checkout.action.default_shipping_method_setter
                            method: setDefaultShippingMethod
                            method_parameters:
                                - $checkout
                    -
                        '@tree':
                            conditions:
                                '@is_multishipping_enabled': null
                            actions:
                                -
                                    '@call_service_method':
                                        service: oro_checkout.action.multi_shipping.default_shipping_method_setter
                                        method: setDefaultShippingMethods
                                        method_parameters:
                                            - $checkout
                    -
                        '@generate_uuid': $state_token
            continue_to_payment_definition:
                preactions:
                    -
                        '@run_action_group':
                            action_group: order_line_items_not_empty
                            parameters_mapping:
                                checkout: $checkout
                            results:
                                result.orderLineItemsNotEmpty: $.orderLineItemsNotEmpty
                                result.orderLineItemsNotEmptyForRfp: $.orderLineItemsNotEmptyForRfp
                    -
                        '@call_service_method':
                            service: oro_checkout.action.default_shipping_method_setter
                            method: setDefaultShippingMethod
                            method_parameters:
                                - $checkout
                    -
                        '@tree':
                            conditions:
                                '@is_multishipping_enabled': null
                            actions:
                                -
                                    '@call_service_method':
                                        service: oro_checkout.action.multi_shipping.default_shipping_method_setter
                                        method: setDefaultShippingMethods
                                        method_parameters:
                                            - $checkout
                                            - $line_items_shipping_methods
                                            - true
                    -
                        '@tree':
                            conditions:
                                '@blank': $.result.checkoutHasApplicableShippingMethods
                            actions:
                                -
                                    '@assign_value':
                                        - $.result.checkoutHasApplicableShippingMethods
                                        - false
                                -
                                    '@assign_value':
                                        conditions:
                                            '@checkout_has_applicable_shipping_methods': $checkout
                                        parameters:
                                            - $.result.checkoutHasApplicableShippingMethods
                                            - true
                preconditions:
                    '@and':
                        -
                            '@equal':
                                parameters:
                                    - $.result.orderLineItemsNotEmptyForRfp
                                    - true
                                message: oro.checkout.workflow.condition.order_line_items_not_empty.not_allow_rfp.message
                        -
                            '@equal':
                                parameters:
                                    - $.result.orderLineItemsNotEmpty
                                    - true
                                message: oro.checkout.workflow.condition.order_line_items_not_empty.allow_rfp.message
                        -
                            '@equal':
                                parameters:
                                    - $.result.checkoutHasApplicableShippingMethods
                                    - true
                                message: oro.checkout.workflow.condition.shipping_method_is_not_available.message
                        -
                            '@quote_acceptable':
                                - $checkout.sourceEntity
                                - true
                conditions:
                    '@and':
                        -
                            '@is_checkout_state_valid':
                                message: oro.checkout.workflow.condition.content_of_order_was_changed.message
                                parameters:
                                    entity: $checkout
                                    token: $state_token
                                    current_state: $.result.currentCheckoutState
                        -
                            '@and':
                                -
                                    '@equal':
                                        - $.result.checkoutHasApplicableShippingMethods
                                        - true
                                -
                                    '@not_empty':
                                        parameters: $checkout.shippingMethod
                                        message: oro.checkout.workflow.condition.shipping_method_is_not_available.message
                        -
                            '@and':
                                -
                                    '@or':
                                        -
                                            '@and':
                                                -
                                                    '@not':
                                                        -
                                                            '@is_multishipping_enabled': null
                                                -
                                                    '@shipping_method_has_enabled_shipping_rules':
                                                        message: oro.checkout.workflow.condition.shipping_method_is_not_available.message
                                                        method_identifier: $checkout.shippingMethod
                                        -
                                            '@and':
                                                -
                                                    '@is_multishipping_enabled': null
                                                -
                                                    '@line_items_shipping_methods_has_enabled_shipping_rules':
                                                        message: oro.checkout.workflow.condition.shipping_method_is_not_available.message
                                                        entity: $checkout
                actions:
                    -
                        '@tree':
                            conditions:
                                '@is_multishipping_enabled': null
                            actions:
                                -
                                    '@call_service_method':
                                        service: oro_checkout.manager.multi_shipping.checkout_line_items_shipping
                                        method: updateLineItemsShippingPrices
                                        method_parameters:
                                            - $checkout
                    -
                        '@run_action_group':
                            action_group: b2b_flow_checkout_update_shipping_method
                            parameters_mapping:
                                checkout: $checkout
                    -
                        '@assign_value':
                            - $.result.shippingPriceUpdated
                            - true
                    -
                        '@call_service_method':
                            service: oro_checkout.action.default_payment_method_setter
                            method: setDefaultPaymentMethod
                            method_parameters:
                                - $checkout
                    -
                        '@generate_uuid': $state_token
            continue_to_order_review_definition:
                preactions:
                    -
                        '@run_action_group':
                            action_group: order_line_items_not_empty
                            parameters_mapping:
                                checkout: $checkout
                            results:
                                result.orderLineItemsNotEmpty: $.orderLineItemsNotEmpty
                                result.orderLineItemsNotEmptyForRfp: $.orderLineItemsNotEmptyForRfp
                    -
                        '@call_service_method':
                            conditions:
                                '@and':
                                    -
                                        '@is_multishipping_enabled': null
                                    -
                                        '@is_line_items_shipping_methods_update_required':
                                            - $checkout.lineItems
                                            - $line_items_shipping_methods
                            parameters:
                                service: oro_checkout.action.multi_shipping.default_shipping_method_setter
                                method: setDefaultShippingMethods
                                method_parameters:
                                    - $checkout
                                    - $line_items_shipping_methods
                    -
                        '@tree':
                            conditions:
                                '@blank': $.result.shippingMethodHasEnabledShippingRules
                            actions:
                                -
                                    '@assign_value':
                                        - $.result.shippingMethodHasEnabledShippingRules
                                        - false
                    -
                        '@tree':
                            conditions:
                                '@and':
                                    -
                                        '@not':
                                            -
                                                '@is_multishipping_enabled': null
                                    -
                                        '@shipping_method_has_enabled_shipping_rules': $checkout.shippingMethod
                            actions:
                                -
                                    '@assign_value':
                                        - $.result.shippingMethodHasEnabledShippingRules
                                        - true
                    -
                        '@tree':
                            conditions:
                                '@and':
                                    -
                                        '@is_multishipping_enabled': null
                                    -
                                        '@line_items_shipping_methods_has_enabled_shipping_rules': $checkout
                            actions:
                                -
                                    '@assign_value':
                                        - $.result.shippingMethodHasEnabledShippingRules
                                        - true
                    -
                        '@call_service_method':
                            conditions:
                                '@blank': $.result.paymentContext
                            parameters:
                                service: oro_checkout.provider.payment_context
                                method: getContext
                                method_parameters:
                                    - $checkout
                                attribute: $.result.paymentContext
                    -
                        '@tree':
                            conditions:
                                '@blank': $.result.hasApplicablePaymentMethods
                            actions:
                                -
                                    '@assign_value':
                                        - $.result.hasApplicablePaymentMethods
                                        - false
                                -
                                    '@assign_value':
                                        conditions:
                                            '@has_applicable_payment_methods': $.result.paymentContext
                                        parameters:
                                            - $.result.hasApplicablePaymentMethods
                                            - true
                preconditions:
                    '@and':
                        -
                            '@equal':
                                - $checkout.completed
                                - false
                        -
                            '@equal':
                                parameters:
                                    - $.result.orderLineItemsNotEmptyForRfp
                                    - true
                                message: oro.checkout.workflow.condition.order_line_items_not_empty.not_allow_rfp.message
                        -
                            '@equal':
                                parameters:
                                    - $.result.orderLineItemsNotEmpty
                                    - true
                                message: oro.checkout.workflow.condition.order_line_items_not_empty.allow_rfp.message
                        -
                            '@equal':
                                parameters:
                                    - $.result.shippingMethodHasEnabledShippingRules
                                    - true
                                message: oro.checkout.workflow.condition.shipping_method_is_not_available.message
                        -
                            '@equal':
                                parameters:
                                    - $.result.hasApplicablePaymentMethods
                                    - true
                                message: oro.checkout.workflow.condition.payment_method_is_not_applicable.message
                        -
                            '@quote_acceptable':
                                - $checkout.sourceEntity
                                - true
                conditions:
                    '@and':
                        -
                            '@check_request':
                                message: oro.checkout.workflow.condition.invalid_request.message
                                parameters:
                                    is_ajax: true
                                    expected_key: _wid
                                    expected_value: ajax_checkout
                        -
                            '@is_checkout_state_valid':
                                message: oro.checkout.workflow.condition.content_of_order_was_changed.message
                                parameters:
                                    entity: $checkout
                                    token: $state_token
                                    current_state: $.result.currentCheckoutState
                        -
                            '@not_empty':
                                message: oro.checkout.workflow.condition.payment_method_was_not_selected.message
                                parameters: $checkout.paymentMethod
                        -
                            '@payment_method_applicable':
                                message: oro.checkout.workflow.condition.payment_method_was_not_selected.message
                                payment_method: $checkout.paymentMethod
                                context: $.result.paymentContext
                actions:
                    -
                        '@tree':
                            conditions:
                                '@equal':
                                    - $payment_validate
                                    - true
                            actions:
                                -
                                    '@assign_constant_value':
                                        - $.result.validateAction
                                        - 'Oro\Bundle\PaymentBundle\Method\PaymentMethodInterface::VALIDATE'
                                -
                                    '@assign_url':
                                        attribute: $.result.successUrl
                                        route: oro_checkout_frontend_checkout
                                        route_parameters:
                                            id: $checkout.id
                                -
                                    '@assign_url':
                                        attribute: $.result.failureUrl
                                        route: oro_checkout_frontend_checkout
                                        route_parameters:
                                            id: $checkout.id
                                            transition: payment_error
                                -
                                    '@payment_validate':
                                        conditions:
                                            '@payment_method_supports':
                                                payment_method: $checkout.paymentMethod
                                                action: $.result.validateAction
                                        attribute: $.result.responseData
                                        object: $checkout
                                        paymentMethod: $checkout.paymentMethod
                                        transactionOptions:
                                            saveForLaterUse: $payment_save_for_later
                                            successUrl: $.result.successUrl
                                            failureUrl: $.result.failureUrl
                                            additionalData: $additional_data
                                            checkoutId: $checkout.id
                    -
                        '@generate_uuid': $state_token
            verify_payment_definition:
                preactions:
                    -
                        '@run_action_group':
                            action_group: order_line_items_not_empty
                            parameters_mapping:
                                checkout: $checkout
                            results:
                                result.orderLineItemsNotEmpty: $.orderLineItemsNotEmpty
                                result.orderLineItemsNotEmptyForRfp: $.orderLineItemsNotEmptyForRfp
                    -
                        '@tree':
                            conditions:
                                '@blank': $.result.requirePaymentRedirect
                            actions:
                                -
                                    '@assign_value':
                                        - $.result.requirePaymentRedirect
                                        - false
                                -
                                    '@assign_value':
                                        conditions:
                                            '@require_payment_redirect':
                                                payment_method: $payment_method
                                        parameters:
                                            - $.result.requirePaymentRedirect
                                            - true
                preconditions:
                    '@and':
                        -
                            '@or':
                                -
                                    '@not':
                                        -
                                            '@check_request':
                                                is_ajax: true
                                                expected_key: _wid
                                                expected_value: ajax_checkout
                                -
                                    '@not':
                                        -
                                            '@check_request':
                                                is_ajax: true
                                                expected_key: transition
                                                expected_value: continue_to_order_review
                        -
                            '@equal':
                                - $checkout.completed
                                - false
                        -
                            '@equal':
                                - $payment_in_progress
                                - false
                        -
                            '@equal':
                                - $.result.requirePaymentRedirect
                                - true
                        -
                            '@equal':
                                parameters:
                                    - $.result.orderLineItemsNotEmptyForRfp
                                    - true
                                message: oro.checkout.workflow.condition.order_line_items_not_empty.not_allow_rfp.message
                        -
                            '@equal':
                                parameters:
                                    - $.result.orderLineItemsNotEmpty
                                    - true
                                message: oro.checkout.workflow.condition.order_line_items_not_empty.allow_rfp.message
                actions:
                    -
                        '@generate_uuid': $state_token
                conditions: {  }
            place_order_definition:
                preactions:
                    -
                        '@flash_message':
                            conditions:
                                '@and':
                                    -
                                        '@equal':
                                            - $payment_in_progress
                                            - true
                                    -
                                        '@equal':
                                            - $checkout.completed
                                            - false
                            message: oro.checkout.workflow.condition.payment_has_not_been_processed.message
                            type: warning
                    -
                        '@call_service_method':
                            conditions:
                                '@and':
                                    -
                                        '@not_empty':
                                            - $.id
                                    -
                                        '@empty': $.result.paymentContext
                            parameters:
                                service: oro_checkout.provider.payment_context
                                method: getContext
                                method_parameters:
                                    - $checkout
                                attribute: $.result.paymentContext
                    -
                        '@call_service_method':
                            conditions:
                                '@and':
                                    -
                                        '@is_multishipping_enabled': null
                                    -
                                        '@is_line_items_shipping_methods_update_required':
                                            - $checkout.lineItems
                                            - $line_items_shipping_methods
                            parameters:
                                service: oro_checkout.action.multi_shipping.default_shipping_method_setter
                                method: setDefaultShippingMethods
                                method_parameters:
                                    - $checkout
                                    - $line_items_shipping_methods
                    -
                        '@assign_value':
                            conditions:
                                '@blank': $.result.shippingMethodHasEnabledShippingRules
                            parameters:
                                attribute: $.result.shippingMethodHasEnabledShippingRules
                                value: false
                    -
                        '@assign_value':
                            conditions:
                                '@or':
                                    -
                                        '@and':
                                            -
                                                '@not':
                                                    -
                                                        '@is_multishipping_enabled': null
                                            -
                                                '@shipping_method_has_enabled_shipping_rules': $checkout.shippingMethod
                                    -
                                        '@and':
                                            -
                                                '@is_multishipping_enabled': null
                                            -
                                                '@line_items_shipping_methods_has_enabled_shipping_rules': $checkout
                            parameters:
                                attribute: $.result.shippingMethodHasEnabledShippingRules
                                value: true
                    -
                        '@tree':
                            conditions:
                                '@blank': $.result.paymentMethodApplicable
                            actions:
                                -
                                    '@assign_value':
                                        - $.result.paymentMethodApplicable
                                        - false
                                -
                                    '@assign_value':
                                        conditions:
                                            '@payment_method_applicable':
                                                payment_method: $checkout.paymentMethod
                                                context: $.result.paymentContext
                                        parameters:
                                            - $.result.paymentMethodApplicable
                                            - true
                    -
                        '@tree':
                            conditions:
                                '@blank': $.result.extendableConditionCheckout
                            actions:
                                -
                                    '@assign_value':
                                        - $.result.extendableConditionCheckout
                                        - false
                                -
                                    '@assign_value':
                                        conditions:
                                            '@extendable':
                                                events:
                                                    - extendable_condition.checkout
                                        parameters:
                                            - $.result.extendableConditionCheckout
                                            - true
                    -
                        '@tree':
                            conditions:
                                '@blank': $.result.extendableConditionPreOrderCreate
                            actions:
                                -
                                    '@assign_value':
                                        - $.result.extendableConditionPreOrderCreate
                                        - false
                                -
                                    '@assign_value':
                                        conditions:
                                            '@extendable':
                                                events:
                                                    - extendable_condition.pre_order_create
                                        parameters:
                                            - $.result.extendableConditionPreOrderCreate
                                            - true
                preconditions:
                    '@and':
                        -
                            '@not_empty': $.result.paymentContext
                        -
                            '@equal':
                                parameters:
                                    - $.result.shippingMethodHasEnabledShippingRules
                                    - true
                                message: oro.checkout.workflow.condition.shipping_method_is_not_available.message
                        -
                            '@equal':
                                parameters:
                                    - $.result.paymentMethodApplicable
                                    - true
                                message: oro.checkout.workflow.condition.payment_method_is_not_applicable.message
                        -
                            '@quote_acceptable':
                                - $checkout.sourceEntity
                                - true
                        -
                            '@equal':
                                - $.result.extendableConditionCheckout
                                - true
                        -
                            '@equal':
                                - $.result.extendableConditionPreOrderCreate
                                - true
                conditions:
                    '@and':
                        -
                            '@is_checkout_state_valid':
                                message: oro.checkout.workflow.condition.content_of_order_was_changed.message
                                parameters:
                                    entity: $checkout
                                    token: $state_token
                                    current_state: $.result.currentCheckoutState
                        -
                            '@extendable':
                                message: oro.checkout.workflow.b2b_flow_checkout.transition.place_order.condition.extendable.message
                                events:
                                    - extendable_condition.before_order_create
                actions:
                    -
                        '@assign_constant_value':
                            - $.result.validateAction
                            - 'Oro\Bundle\PaymentBundle\Method\PaymentMethodInterface::VALIDATE'
                    -
                        '@assign_url':
                            attribute: $.result.failedShippingAddressUrl
                            route: oro_checkout_frontend_checkout
                            route_parameters:
                                id: $checkout.id
                                transition: back_to_shipping_address_on_fail_address
                    -
                        '@run_action_group':
                            action_group: b2b_flow_checkout_place_order
                            parameters_mapping:
                                checkout: $checkout
                            results:
                                data.order: $.order
                    -
                        '@call_service_method':
                            service: oro_checkout.provider.multi_shipping_config
                            method: isCreateSubOrdersForEachGroupEnabled
                            method_parameters: {  }
                            attribute: $.result.createSubOrdersForLineItemsGroup
                    -
                        '@tree':
                            conditions:
                                '@and':
                                    -
                                        '@equal':
                                            - $.result.createSubOrdersForLineItemsGroup
                                            - true
                                    -
                                        '@not_empty': $grouped_line_items
                            actions:
                                -
                                    '@run_action_group':
                                        action_group: b2b_flow_checkout_create_child_orders
                                        parameters_mapping:
                                            checkout: $checkout
                                            order: $order
                                            groupedLineItemsIds: $grouped_line_items
                    -
                        '@assign_value':
                            - $payment_in_progress
                            - true
                    -
                        '@run_action_group':
                            action_group: b2b_flow_checkout_purchase
                            parameters_mapping:
                                checkout: $checkout
                                order: $order
                                transactionOptions:
                                    failedShippingAddressUrl: $.result.failedShippingAddressUrl
                                    additionalData: $additional_data
                            results:
                                result.responseData: $.responseData
                    -
                        '@extendable':
                            events:
                                - extendable_action.finish_checkout
                    -
                        '@assign_url':
                            conditions:
                                '@equal':
                                    - '$.result.responseData[purchasePartial]'
                                    - true
                            parameters:
                                attribute: $.result.responseData.partiallyPaidUrl
                                route: oro_checkout_frontend_checkout
                                route_parameters:
                                    id: $checkout.id
                                    transition: paid_partially
                    -
                        '@redirect':
                            conditions:
                                '@and':
                                    -
                                        '@equal':
                                            - '$.result.responseData[purchaseSuccessful]'
                                            - true
                                    -
                                        '@payment_method_supports':
                                            payment_method: $checkout.paymentMethod
                                            action: $.result.validateAction
                            route: oro_checkout_frontend_checkout
                            route_parameters:
                                id: $checkout.id
                                transition: finish_checkout
                    -
                        '@redirect':
                            conditions:
                                '@and':
                                    -
                                        '@equal':
                                            - '$.result.responseData[purchaseSuccessful]'
                                            - false
                                    -
                                        '@payment_method_supports':
                                            payment_method: $checkout.paymentMethod
                                            action: $.result.validateAction
                            route: oro_checkout_frontend_checkout
                            route_parameters:
                                id: $checkout.id
                                transition: payment_error
                    -
                        '@generate_uuid': $state_token
            recalculate_state_definition:
                preconditions:
                    '@equal':
                        - $checkout.completed
                        - false
                actions:
                    -
                        '@run_action_group':
                            action_group: oro_update_shipping_price
                            parameters_mapping:
                                checkout: $checkout
                    -
                        '@assign_value':
                            -
                                - $.result.shippingPriceUpdated
                                - true
                            -
                                - $payment_in_progress
                                - false
                    -
                        '@generate_uuid': $state_token
                preactions: {  }
                conditions: {  }
            back_to_shipping_method_definition:
                preconditions:
                    '@equal':
                        - $checkout.completed
                        - false
                actions:
                    -
                        '@assign_value':
                            -
                                - $payment_method
                                - null
                            -
                                - $payment_in_progress
                                - false
                            -
                                - $shipping_method
                                - null
                            -
                                - $checkout.shippingCost
                                - null
                    -
                        '@call_service_method':
                            service: oro_checkout.action.default_shipping_method_setter
                            method: setDefaultShippingMethod
                            method_parameters:
                                - $checkout
                    -
                        '@tree':
                            conditions:
                                '@is_multishipping_enabled': null
                            actions:
                                -
                                    '@call_service_method':
                                        service: oro_checkout.action.multi_shipping.default_shipping_method_setter
                                        method: setDefaultShippingMethods
                                        method_parameters:
                                            - $checkout
                    -
                        '@generate_uuid': $state_token
                preactions: {  }
                conditions: {  }
            clear_payment_method_and_recalculate_state_definition:
                preconditions:
                    '@equal':
                        - $checkout.completed
                        - false
                actions:
                    -
                        '@assign_value':
                            -
                                - $payment_method
                                - null
                            -
                                - $payment_in_progress
                                - false
                            -
                                - $shipping_method
                                - null
                            -
                                - $checkout.shippingCost
                                - null
                    -
                        '@generate_uuid': $state_token
                preactions: {  }
                conditions: {  }
            finish_checkout_definition:
                conditions:
                    '@and':
                        -
                            '@not_empty':
                                - $order
                        -
                            '@equal':
                                - $payment_in_progress
                                - true
                actions:
                    -
                        '@run_action_group':
                            action_group: handle_late_registration
                            parameters_mapping:
                                checkout: $checkout
                                order: $order
                                late_registration_data: $late_registration
                    -
                        '@run_action_group':
                            action_group: b2b_flow_checkout_finish_checkout
                            parameters_mapping:
                                checkout: $checkout
                                order: $order
                                auto_remove_source: $auto_remove_source
                                allow_manual_source_remove: $allow_manual_source_remove
                                remove_source: $remove_source
                                clear_source: $clear_source
                    -
                        '@delete_checkout_state':
                            entity: $checkout
                preactions: {  }
                preconditions: {  }
            paid_partially_definition:
                actions:
                    -
                        '@tree':
                            conditions:
                                '@not_empty': $order
                            actions:
                                -
                                    '@assign_url':
                                        attribute: $.result.orderViewPage
                                        route: oro_order_frontend_view
                                        route_parameters:
                                            id: $order.id
                                -
                                    '@flash_message':
                                        message: oro.checkout.workflow.condition.payment_has_not_fully_been_processed.message
                                        message_parameters:
                                            orderIdentifier: $order.identifier
                                            orderViewLink: $.result.orderViewPage
                                        type: warning
                                -
                                    '@actualize_line_items_by_unpaid_suborders':
                                        order: $order
                                        checkout: $checkout
                                -
                                    '@call_service_method':
                                        service: oro_checkout.provider.grouped_line_items
                                        method: getGroupedLineItemsIds
                                        method_parameters:
                                            - $checkout
                                        attribute: $grouped_line_items
                    -
                        '@flash_message':
                            conditions:
                                '@empty': $order
                            message: oro.checkout.workflow.condition.payment_has_not_fully_been_processed.message
                            message_parameters:
                                orderIdentifier: $order.identifier
                                orderViewLink: $.result.orderViewPage
                            type: warning
                    -
                        '@assign_value':
                            -
                                - $payment_method
                                - null
                            -
                                - $payment_in_progress
                                - false
                    -
                        '@unset_value':
                            - $.data.order
                    -
                        '@generate_uuid': $state_token
                    -
                        '@delete_checkout_state':
                            entity: $checkout
                            token: $state_token
                    -
                        '@generate_checkout_state_snapshot':
                            entity: $checkout
                            attribute: $.result.currentCheckoutState
                    -
                        '@save_checkout_state':
                            entity: $checkout
                            state: $.result.currentCheckoutState
                            token: $state_token
                preactions: {  }
                preconditions: {  }
                conditions: {  }
        force_autostart: false
        scopes: {  }
        datagrids: {  }
        disable_operations: {  }
        entity_restrictions: {  }

